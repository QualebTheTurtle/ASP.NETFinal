# ASP.NET MVC Tutorial Morosko Final

## Intro to MVC

### What is MVC????
> MVC stands for Model View Controler. It is an archetectural pattern, or a way to logically organize and structure programs. MVC is not a framework, however it is commonly used by many frameworks such as Ruby on Rails and django. With MVC your program is orgamized in such a way that the Model is anything pertaining to the data of your program, being properties and databases. Views are anything pertaining to the "stuff" put out to the users screen. Finally Controller is for anything pertaining to processing information from user gathering info from the Model and View to create the final view and output to the user.
>#### MVC With ASP.NET And Web Development
>MVC can be related to the client server model in Web development. The user (you at your house) makes a request to a server, that server then requests information to a dataserver. The data server sends the requested information back and the server compiles a veiw to send to the user.
> 
>![alt text][img1]
>
>The senario above Is the same model with MVC applied where the user makes a request. The server controls the request, and gathers information from the model. The server then generates a view and reterns it to the user.

### Lets Get to It
Now that you understand the basics of MVC lets try to enforce MVC by creating an ASP.net web application using MVC. Were going to recreate the dog lab from earlier in the semester, but using MVC. To start open up Visual Studio and click file new Project, or press Ctrl+Shift+N.

![alt text][img2]

Fom there, in the left pane select templates, visual C#, finally web. 

![alt text][img3]

If you know git source control feel free to checkmark that box in the bottom right. Within the dialog box select the option circled below and name the project "DogzRRuff" in the text box at the bottom, and click Ok.

![alt text][img4]

From the teplate dialog box select MVC from the options in the top pane. You may also have host in the cloud checked, uncheck it. Click Ok to continue.

![alt text][img5]

Stright away we can see that Visual Studio has autogenerated a multitude of files and folders for us. Notice the Model, Views and Controller folders.

![alt text][img6]

MVC in Visual studio comes with alot of pre-built view's. Including login features and starting pages for home, about and contact. To start, lets run the code and take a look at what comes pre-built. To do this type Ctrl+F5. After viewing whats created by default lets make some changes to the homepage. Lets change the "Application name" homepage link in the top left to say DogzRRuff. 

![alt text][img7]

### Changing Application Name 

> To change the text for that open the solution explorer go to veiws and shared and open the \_Layout.cshtml. 
> 
> ![alt text][img8]
> 
> This is a Razor file. Raxor files end in .cshtml or .vbhtml and they are a mixture of C# or VB and HTML tags. Edit line 20 to 
> 
> ```csharp
> @Html.ActionLink("DogzRRuff", "Index", "Home", new { area = "" }, new { @class = "navbar-brand" })
> ```
> 
> Once edited hit Ctrl+Shift+B to rebuild the solution. Go to your web browser and refresh. From here we will change the words in our title and footer to reflect our new application name. Change lines 6 to
> ```csharp
> <title>@ViewBag.Title - DogzRRuff</title>
> ```
> and 36 to
> ```csharp
> <p>&copy; @DateTime.Now.Year - DogzRRuff</p>
> ```
> The website sould have the following changes after a build(Ctrl+Shift+B) and a refresh of your browser.
> 
> ![alt text][img9]
>

Were going to make the website look like this in the next section.

![alt text][img11]

### Changing the Home Page Content in MVC
> In MVC a view is created from a multitude of veiws or partial views. The view we edited previously is a partial view that all pages of the website share unless otherwize specified. Lets break that veiw down to better understand before we move on. At the top of the veiw there are normal HTML tags, going on we see an @ symbol. The @ denotes the usage of csharp. The first instance of an @ symbol that we see is on line 6
>
> ```csharp
>     <title>@ViewBag.Title - DogzRRuff</title>
> ```
> This line is an html title tag the csharp code after the @ symbol is ViewBag.Title this code creates a temporary variable called title that can be passed values from the partial view that is put in further down.
> The next line of intrest is line 33
> ```csharp
> @RenderBody()
> ```
> RenderBody function is a helper function that is implemented in MVC it is where the partial veiws to be passedin will be placed.
> Now that we understand the Shared partial veiw lets edit the body of the HomePage. To do this navigate to Views, Home, and opent the Index.cshtml file. 
> 
> ![alt text][img10]
> 
> This is the partial view that is output by the @RenderBody() function when we navigate to our localhost, or Localhost/home. Before we break the code down make it look like this
>
> ```csharp
>@{
>     ViewBag.Title = "Home Page";
> }
>
> <div class="jumbotron">
>     <h1>Dogz 'R' Ruff</h1>
>     <p>DogzRRuff is all about the dogs that have inpacted my life.</p> 
> </div>
> 
> <div class="row">
>    <div class="col-md-4">
>         <h2>Register With Us</h2>
>         <p>
>             To learn more about the good the bad and the ruff of my dogs create an account with us.
>         </p>
>         <p><a href="@Url.Action("Register", "Account")" class="btn btn-default btn-lg">Register</a></p>
>     </div>
>     <div class="col-md-4">
>         <h2>Login</h2>
>         <p>
>             If you already have an account please feel free to login.
>         </p>
>         <p><a href="@Url.Action("Login", "Account")" class="btn btn-default btn-lg">Login</a></p>
>     </div>
> </div>
> ```
> 
> The `@{ViewBag.Title = "Home Page";}` is our first line to break down. The @ indicates csharp code putting {} any code inbetween can be csharp. Whereas @ indicates a single line of csharp. As mentioned previously, setting ViewBag.Title to a string value passes that string value to the html title tag.
> 
> Moving on we se a div element with a class of jumbotron. One of the things that comes with MVC is Bootstrap, which is a front end component library that makes has alot of neat things that help HTML, CSS ans Javascript to be easier and more responsive. We will not go into this in detail, however feel free to resarch at [W3Schools.com](http://www.w3schools.com). Jumbotron class creates a big grey box and any text inside is further exagerated.
>
>The next div includes two inner divs both if which are similar. The `@Url.Action()` function returns a Url when passed certain parameters. The first instance of this returns a url of "localhost/Accout/Register". This then opens the Register partial page within the @RenderBody() section of the shared \_Layout.cshtml file.
>
>Now that we better uderstand the changes weve made lets view them by pressing Ctrl+Shift+B to build our project and the refresh in our web browzer.
> If you see the image below then congragulations you now know the basics of editing Views in MVC. 
>
> ![alt text][img11]
>

Next were going to Work with Models and controllers to change the register page slightly.

### Changing the Registers Page
> First were going to add a database to the project. There are many ways to do this, in MVC its easiest to create an account using the registers page. You will know you have a successful registar when it redirects you to the home page and you can see your email and logout in the top right.
> 
> ![alt text][img12]
> 
> Once Created in visual studio in the App_Data Folder there should be a database file(red circle). To see this file you may have to press the view all files button(blue circle).
>
> ![alt text][img13]
>
> You will need to then open the package manager console and type "Enable-Migrations" and press enter.
>
> ![alt text][img14]
>
> Next we need to edit the identity model. Open the Models, IdentityModels.cs. Scroll down until you see the ApplicationUser class and add these properties to it.
> ```csharp
> public class ApplicationUser : IdentityUser
>    {
>         public string fName { get; set; }
>         public string lName { get; set; }   
>
>         public async Task<ClaimsIdentity> GenerateUserIdentityAsync(UserManager<ApplicationUser> manager)
>         {
>             // Note the authenticationType must match the one defined in CookieAuthenticationOptions.AuthenticationType
>             var userIdentity = await manager.CreateIdentityAsync(this, DefaultAuthenticationTypes.ApplicationCookie);
>            // Add custom user claims here
>             return userIdentity;
>         }
>     }
> ```
> Next go back to the Console and type "Add-Migration "fName"" hit enter.
> Then type "Update-Database" hit enter.
> Repeat the last two steps replaceing fname in step 1 with lname.
> Finaly you have added first name and last name to the database to check double click the database file. In the Server Explorer window, select the tables dropdown then AspNetUsers and notice the fName and lName near the bottom.
> 
> ![alt text][img15]
>
> Next we need to edit the RegisterViewModel. This model has logic for any information that the user may send in a request from from that view. To get to the RegisterVeiwModel navigate to Models, AccountViewModel, RegisterViewModel.
> 
> ![alt text][img16]
> 
> Edit the RegisterViewModel class to look like below
>
> ```csharp
>     public class RegisterViewModel
>     {
>         [Required]
>         [Display(Name = "Username")]
>         public string Username { get; set; }
> 
>         [Required]
>         [Display(Name = "First Name")]
>         public string FirstName { get; set; }
> 
>         [Required]
>         [Display(Name = "Last Name")]
>         public string LastName { get; set; }
>
>         [Required]
>         [EmailAddress]
>         [Display(Name = "Email")]
>         public string Email { get; set; }
>
>         [Required]
>         [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
>         [DataType(DataType.Password)]
>         [Display(Name = "Password")]
>        public string Password { get; set; }
>
>         [DataType(DataType.Password)]
>         [Display(Name = "Confirm password")]
>         [Compare("Password", ErrorMessage = "The password and confirmation password do not match.")]
>         public string ConfirmPassword { get; set; }
>     }
>```
> 
> Now that weve edited the Model side of MVC we need to edit the Controler. To edit the controler for Register page we need to find the Register method that takes a parameter of a register view.
> 


[img1]: img/MVCDiagram.jpg "Tutorial img 1 shows a visual helpper of MVC. Created by Caleb Wagner using Microsoft Visio."
[img2]: img/Step1.png "Tutorial img 2 shows a visual of above text. Created by Caleb Wagner."
[img3]: img/Step2.png "Tutorial img 3 shows a visual of above text. Created by Caleb Wagner."
[img4]: img/Step3.png "Tutorial img 4 shows a visual of above text. Created by Caleb Wagner."
[img5]: img/Step4.png "Tutorial img 5 shows a visual of above text. Created by Caleb Wagner."
[img6]: img/Step5.png "Tutorial img 6 shows a visual of above text. Created by Caleb Wagner."
[img7]: img/Step6.png
[img8]: img/Step7.png
[img9]: img/Step8.png
[img10]: img/Step9.png
[img11]: img/Step10.png
[img12]: img/Step11.png
[img13]: img/Step12.png
[img14]: img/Step13.png
[img15]: img/Step14.png
[img16]: img/Step15.png
